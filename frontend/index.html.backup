<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KH SYSTEM</title>
    <link rel="stylesheet" href="css/style.css">

<style>
/* 엑셀 버튼 hover 효과 */
button[onclick*="downloadExcelTemplate"]:hover {
    background: #4CAF50 !important;
    color: white !important;
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(76, 175, 80, 0.3);
}

button[onclick*="showExcelUploadModal"]:hover {
    background: #2196F3 !important;
    color: white !important;
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(33, 150, 243, 0.3);
}

button[onclick*="downloadExcel"]:hover {
    background: #0066cc !important;
    color: white !important;
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(0, 102, 204, 0.3);
}
</style>
</head>
<body>
   <div class="header">
    <!-- 햄버거 버튼 (모바일용) -->
        <button class="hamburger-btn" id="hamburgerBtn" onclick="toggleMobileMenu()">
            <span></span>
            <span></span>
            <span></span>
        </button>
        
        <div class="logo">KH SYSTEM</div>
        
        <div class="user-info" id="userInfo" style="display: none;">
    <!-- 알림 아이콘 -->
        <div class="notification-wrapper">
            <button class="notification-btn" onclick="toggleNotificationDropdown()">
                🔔
                <span class="notification-badge" id="notificationBadge" style="display: none;">0</span>
            </button>
            <div class="notification-dropdown" id="notificationDropdown">
                <div class="notification-header">
                    <span>알림</span>
                    <button onclick="markAllNotificationsRead()">모두 읽음</button>
                </div>
                <div class="notification-list" id="notificationList">
                    <p class="no-notifications">새로운 알림이 없습니다.</p>
                </div>
            </div>
        </div>
        
            <div class="user-dropdown">
                <button class="user-dropdown-btn" onclick="toggleUserDropdown()">
                    <span class="user-name" id="currentUser"></span>
                    <span class="dropdown-arrow">▼</span>
                </button>
                <div class="user-dropdown-menu" id="userDropdownMenu">
                    <a href="#" onclick="openMyPage(); closeUserDropdown();">👤 마이페이지</a>
                    <a href="#" onclick="logout(); closeUserDropdown();">🚪 로그아웃</a>
                </div>
            </div>
        </div>
    </div>
    <!-- 모바일 메뉴 오버레이 -->
    <div class="mobile-menu-overlay" id="mobileMenuOverlay" onclick="closeMobileMenu()"></div>

    <nav class="nav" id="mainNav">
        <ul class="nav-menu" id="navMenu">
            <li class="nav-item active" id="navList" onclick="closeMobileMenu()">자산 조회</li>
            <li class="nav-item" id="navRegister" onclick="closeMobileMenu()">자산 등록</li>
            <li class="nav-item" id="navDashboard" onclick="closeMobileMenu()">현황</li>
            <li class="nav-item" id="navChat" onclick="closeMobileMenu()">💬 채팅</li>
            <li class="nav-item" id="navFeed" onclick="closeMobileMenu()">📸 피드</li>
            <li class="nav-item" id="navReels" onclick="closeMobileMenu()">🎬 릴스</li>
            <li class="nav-item" id="navSettings" onclick="closeMobileMenu()">페이지 관리</li>
            <li class="nav-item" id="navAdmin" onclick="closeMobileMenu()">관리자</li>
        </ul>
    </nav>

    <div id="loginPage" class="login-container">
        <div class="login-box">
            <h2>안녕하세요.</h2>
            
            <div class="tabs">
                <div class="tab active" id="loginTab">로그인</div>
                <div class="tab" id="signupTab">회원가입</div>
            </div>

            <div id="messageBox"></div>

            <form id="loginForm">
                <div class="form-group">
                    <label>이메일</label>
                    <input type="email" id="loginEmail" required autocomplete="username">
                    <small class="form-help" id="loginEmailError"></small>
                </div>
                <div class="form-group">
                    <label>비밀번호</label>
                    <div class="password-input-wrapper">
                        <input type="password" id="loginPassword" required autocomplete="current-password">
                        <button type="button" class="password-toggle" onclick="togglePassword('loginPassword')">
                            <span class="eye-icon">👁️</span>
                        </button>
                    </div>
                    <small class="form-help" id="loginAttempts"></small>
                </div>
                <button type="submit" class="btn-primary">로그인</button>
                <p style="text-align: center; margin-top: 15px;">
                    <a href="#" onclick="showForgotPassword()" style="color: #0066cc; text-decoration: none; font-size: 14px;">비밀번호를 잊으셨나요?</a>
                </p>
            </form>

            <!-- 비밀번호 찾기 폼 -->
            <form id="forgotPasswordForm" class="hidden">
                <div class="form-group">
                    <label>가입한 이메일</label>
                    <input type="email" id="forgotEmail" required placeholder="example@email.com">
                    <small class="form-help">가입 시 사용한 이메일을 입력하세요.</small>
                </div>
                <button type="submit" class="btn-primary" style="width: 100%;">임시 비밀번호 받기</button>
                <p style="text-align: center; margin-top: 15px;">
                    <a href="#" onclick="showLoginForm()" style="color: #666; text-decoration: none; font-size: 14px;">← 로그인으로 돌아가기</a>
                </p>
            </form>

            <form id="signupForm" class="hidden">
                <div class="form-group">
                    <label>이름</label>
                    <input type="text" id="signupName" required minlength="2">
                    <small class="form-help">최소 2자 이상</small>
                </div>
                <div class="form-group">
                    <label>이메일</label>
                    <input type="email" id="signupEmail" required autocomplete="username">
                    <small class="form-help" id="emailHelp">이거 임의로 생성해도댐</small>
                </div>
                <div class="form-group">
                    <label>비밀번호</label>
                    <div class="password-input-wrapper">
                        <input type="password" id="signupPassword" required minlength="8" autocomplete="new-password">
                        <button type="button" class="password-toggle" onclick="togglePassword('signupPassword')">
                            <span class="eye-icon">👁️</span>
                        </button>
                    </div>
                    <div class="password-strength" id="passwordStrength">
                        <div class="strength-bar">
                            <div class="strength-bar-fill" id="strengthBar"></div>
                        </div>
                        <small class="strength-text" id="strengthText">비밀번호를 입력하세요</small>
                    </div>
                    <small class="form-help">최소 8자, 대/소문자, 숫자, 특수문자 중 3가지 이상</small>
                </div>
                <div class="form-group">
                    <label>비밀번호 확인</label>
                    <div class="password-input-wrapper">
                        <input type="password" id="signupConfirm" required autocomplete="new-password">
                        <button type="button" class="password-toggle" onclick="togglePassword('signupConfirm')">
                            <span class="eye-icon">👁️</span>
                        </button>
                    </div>
                    <small class="form-help" id="confirmHelp"></small>
                </div>
                <button type="submit" class="btn-primary">회원가입</button>
            </form>
        </div>
    </div>

    <div id="registerPage" class="main-content">
        <h1 class="page-title">자산 등록</h1>
        <div class="asset-form">
            <div class="form-section">
                <form id="assetForm">
                    <h3 class="section-title">기본 정보</h3>
                    <div class="form-grid" id="basicInfoGrid">
                        <!-- 동적으로 생성됨 -->
                    </div>
                    
                    <h3 class="section-title">추가 정보</h3>
                    <div class="form-grid" id="additionalInfoGrid">
                        <!-- 동적으로 생성됨 -->
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit" class="btn-submit">
                            <span>등록하기</span>
                        </button>
                        <button type="reset" class="btn-reset">
                            <span>초기화</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div id="listPage" class="main-content">
        <h1 class="page-title">자산 조회</h1>
        <div style="background: #e3f2fd; border-left: 4px solid #0066cc; padding: 12px 20px; margin-bottom: 15px; border-radius: 4px;">
            <p style="margin: 0; color: #002c5f; font-size: 14px;">
                💡 <strong>팁:</strong> 테이블 헤더를 드래그하여 컬럼 순서를 변경하거나, 헤더 오른쪽 끝을 드래그하여 크기를 조절할 수 있습니다.
            </p>
        </div>
        <div style="display: flex; gap: 8px; margin-bottom: 15px;">
            <button onclick="downloadExcelTemplate()" style="flex: 1; padding: 10px; background: white; color: #4CAF50; border: 1.5px solid #4CAF50; border-radius: 6px; cursor: pointer; font-size: 13px; font-weight: 600; transition: all 0.2s;">
                📄 템플릿
            </button>
            <button onclick="showExcelUploadModal()" style="flex: 1; padding: 10px; background: white; color: #2196F3; border: 1.5px solid #2196F3; border-radius: 6px; cursor: pointer; font-size: 13px; font-weight: 600; transition: all 0.2s;">
                📤 업로드
            </button>
            <button onclick="downloadExcel()" style="flex: 1; padding: 10px; background: white; color: #0066cc; border: 1.5px solid #0066cc; border-radius: 6px; cursor: pointer; font-size: 13px; font-weight: 600; transition: all 0.2s;">
                📥 다운로드
            </button>
        </div>
        
        <!-- 검색바 -->
        <div class="search-bar-container" style="background: white; border: 1.5px solid #e0e0e0; border-radius: 8px; padding: 15px; margin-bottom: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.05);">
            <div class="search-bar-grid" style="display: grid; grid-template-columns: 200px 1fr auto; gap: 10px; align-items: center;">
                <select id="searchField" style="padding: 10px 12px; border: 1.5px solid #ddd; border-radius: 6px; font-size: 14px; color: #333; cursor: pointer; background: white; transition: all 0.2s;">
                    <option value="">전체</option>
                </select>
                <div style="position: relative;">
                    <input type="text" id="searchInput" placeholder="검색어를 입력하세요..." 
                        style="width: 100%; padding: 10px 40px 10px 15px; border: 1.5px solid #ddd; border-radius: 6px; font-size: 14px; transition: all 0.2s; box-sizing: border-box;"
                        onkeypress="if(event.key === 'Enter') searchAssets()">
                    <span style="position: absolute; right: 12px; top: 50%; transform: translateY(-50%); color: #999; font-size: 18px; pointer-events: none;">🔍</span>
                </div>
                <div class="search-buttons" style="display: flex; gap: 8px;">
                    <button onclick="searchAssets()" style="padding: 10px 24px; background: #0066cc; color: white; border: none; border-radius: 6px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.2s; white-space: nowrap;">
                        검색
                    </button>
                    <button onclick="resetSearch()" style="padding: 10px 20px; background: white; color: #666; border: 1.5px solid #ddd; border-radius: 6px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.2s; white-space: nowrap;">
                        초기화
                    </button>
                </div>
            </div>
        </div>


        <div class="table-container">
            <table id="assetTable">
                <thead>
                    <tr id="tableHeader">
                    </tr>
                </thead>
                <tbody id="assetTableBody">
                </tbody>
            </table>
        </div>
        <div class="pagination-container" id="paginationContainer">
            <div class="pagination-info">
                <span id="paginationInfo">총 0개</span>
            </div>
            <div class="pagination-buttons" id="paginationButtons">
            </div>
        </div>
    </div>

    <!-- 대시보드 페이지 -->
    <div id="dashboardPage" class="main-content">
        <h1 class="page-title">📊 현황</h1>
        
        <div class="dashboard-controls" style="background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
            <h3 style="margin-bottom: 15px; color: #002c5f;">그래프 설정</h3>
            <div style="display: flex; gap: 15px; align-items: end; flex-wrap: wrap;">
                <div style="flex: 1; min-width: 200px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #666;">그래프 종류</label>
                    <select id="chartType" style="width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 6px; font-size: 14px;">
                        <option value="bar">막대 그래프</option>
                        <option value="pie">원 그래프</option>
                        <option value="line">선 그래프</option>
                        <option value="doughnut">도넛 그래프</option>
                    </select>
                </div>
                <div style="flex: 1; min-width: 200px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #666;">분석 항목</label>
                    <select id="analyzeField" style="width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 6px; font-size: 14px;">
                        <option value="">항목 선택</option>
                    </select>
                </div>
                <div style="flex: 1; min-width: 200px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #666;">집계 방식</label>
                    <select id="aggregateType" style="width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 6px; font-size: 14px;">
                        <option value="count">개수</option>
                        <option value="sum">합계 (가격)</option>
                        <option value="avg">평균 (가격)</option>
                    </select>
                </div>
                <button type="button" class="btn-primary" id="generateChartBtn" style="padding: 10px 30px; height: 44px;">
                    그래프 생성
                </button>
            </div>
        </div>
        
        <div class="dashboard-stats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
            <div class="stat-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                <div style="font-size: 14px; opacity: 0.9;">전체 자산</div>
                <div style="font-size: 32px; font-weight: bold; margin: 10px 0;" id="totalAssets">0</div>
            </div>
            <div class="stat-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                <div style="font-size: 14px; opacity: 0.9;">총 자산 가치</div>
                <div style="font-size: 32px; font-weight: bold; margin: 10px 0;" id="totalValue">0원</div>
            </div>
            <div class="stat-card" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                <div style="font-size: 14px; opacity: 0.9;">평균 가격</div>
                <div style="font-size: 32px; font-weight: bold; margin: 10px 0;" id="avgPrice">0원</div>
            </div>
        </div>
        
       <div class="chart-container" style="background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); position: relative;">
            <button type="button" id="openChartSettings" style="position: absolute; top: 20px; right: 20px; background: #667eea; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 14px; display: flex; align-items: center; gap: 5px; box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3); transition: all 0.3s;">
                <span>⚙️</span>
                <span>차트 설정</span>
            </button>
            <canvas id="mainChart" style="max-height: 400px;"></canvas>
        </div>

        
        <!-- 차트 설정 모달 -->
        <div id="chartSettingsModal" class="modal">
            <div class="modal-content" style="max-width: 400px;">
                <div class="modal-header">
                    <h2>⚙️ 차트 설정</h2>
                    <span class="close-modal" id="closeChartSettings">&times;</span>
                </div>
                <div style="padding: 30px;">
                    <div style="margin-bottom: 20px;">
                        <label style="display: flex; align-items: center; cursor: pointer; padding: 10px; background: #f8f9fa; border-radius: 6px; margin-bottom: 10px; transition: background 0.2s;">
                            <input type="checkbox" id="showLegend" checked style="margin-right: 10px; width: 18px; height: 18px; cursor: pointer;">
                            <span style="font-size: 14px;">범례 표시</span>
                        </label>
                        
                        <label style="display: flex; align-items: center; cursor: pointer; padding: 10px; background: #f8f9fa; border-radius: 6px; margin-bottom: 10px; transition: background 0.2s;">
                            <input type="checkbox" id="showTitle" checked style="margin-right: 10px; width: 18px; height: 18px; cursor: pointer;">
                            <span style="font-size: 14px;">제목 표시</span>
                        </label>
                        
                        <label style="display: flex; align-items: center; cursor: pointer; padding: 10px; background: #f8f9fa; border-radius: 6px; margin-bottom: 10px; transition: background 0.2s;">
                            <input type="checkbox" id="showGrid" checked style="margin-right: 10px; width: 18px; height: 18px; cursor: pointer;">
                            <span style="font-size: 14px;">격자선 표시</span>
                        </label>
                        
                        <label style="display: flex; align-items: center; cursor: pointer; padding: 10px; background: #f8f9fa; border-radius: 6px; margin-bottom: 10px; transition: background 0.2s;">
                            <input type="checkbox" id="showAnimation" checked style="margin-right: 10px; width: 18px; height: 18px; cursor: pointer;">
                            <span style="font-size: 14px;">애니메이션</span>
                        </label>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #666; font-size: 13px;">범례 위치</label>
                        <select id="legendPosition" style="width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 6px; font-size: 14px;">
                            <option value="top">상단</option>
                            <option value="bottom">하단</option>
                            <option value="left">좌측</option>
                            <option value="right" selected>우측</option>
                        </select>
                    </div>
                    
                    <div style="margin-bottom: 25px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #666; font-size: 13px;">차트 높이</label>
                        <input type="range" id="chartHeight" min="300" max="600" value="400" step="50" style="width: 100%;">
                        <div style="text-align: center; font-size: 12px; color: #999; margin-top: 5px;">
                            <span id="chartHeightValue">400</span>px
                        </div>
                    </div>
                    
                    <div class="modal-buttons">
                        <button type="button" class="btn-primary" id="applyChartSettings" style="flex: 1;">
                            설정 적용
                        </button>
                        <button type="button" class="btn-reset_c" id="resetChartSettings" style="flex: 1;">
                            초기화
                        </button>
                    </div>
                </div>
            </div>
        </div>  
    </div>

    <!-- 엑셀 업로드 모달 -->
    <div id="excelUploadModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2>엑셀 파일 업로드</h2>
                <button class="close-btn" onclick="closeExcelUploadModal()">×</button>
            </div>
            <div class="modal-body">
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 10px; font-weight: 600;">엑셀 파일 선택</label>
                    <input type="file" id="excelFileInput" accept=".xlsx, .xls" 
                           style="width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 6px;">
                    <p style="margin-top: 8px; color: #666; font-size: 13px;">
                        💡 엑셀 템플릿을 다운로드하여 양식에 맞춰 작성해주세요.
                    </p>
                </div>
                
                <div id="excelPreview" style="display: none;">
                    <h3 style="margin-bottom: 10px;">미리보기</h3>
                    <div id="excelPreviewContent" style="max-height: 300px; overflow: auto; border: 1px solid #ddd; border-radius: 6px; padding: 10px; background: #f9f9f9;">
                    </div>
                    <div id="excelStats" style="margin-top: 15px; padding: 15px; background: #e3f2fd; border-radius: 6px;">
                    </div>
                </div>
                
                <div class="modal-buttons" style="margin-top: 20px;">
                    <button type="button" onclick="processExcelUpload()" class="btn-primary" id="uploadExcelBtn" disabled>
                        업로드 및 등록
                    </button>
                    <button type="button" onclick="closeExcelUploadModal()" class="btn-secondary">
                        취소
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="adminPage" class="main-content">
        <h1 class="page-title">회원 관리</h1>
        <div class="user-list" id="userListContainer"></div>
    </div>

    
    <!-- 채팅 페이지 -->
    <div id="chatPage" class="main-content">
        <h1 class="page-title">💬 채팅</h1>
        
        <div class="chat-container" style="display: grid; grid-template-columns: 300px 1fr; gap: 20px; height: calc(100vh - 200px);">
            <!-- 채팅방 목록 -->
            <div class="chat-room-list-container" id="chatRoomListContainer" style="background: white; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); display: flex; flex-direction: column;">
                <div style="padding: 15px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center;">
                    <h3 style="margin: 0; font-size: 16px;">대화 목록</h3>
                    <button onclick="openNewChatModal()" style="padding: 8px 12px; background: #0066cc; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 13px;">
                        + 새 채팅
                    </button>
                </div>
                <div id="chatRoomList" style="flex: 1; overflow-y: auto; padding: 10px;">
                    <p style="text-align: center; color: #999; padding: 20px;">채팅방이 없습니다.</p>
                </div>
            </div>
            
            <!-- 채팅 영역 -->
            <div class="chat-area-container" id="chatAreaContainer" style="background: white; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); display: flex; flex-direction: column;">
                <!-- 채팅 헤더 -->
                <div id="chatHeader" style="padding: 15px 20px; border-bottom: 1px solid #eee; display: none;">
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <button id="backToChatList" onclick="showChatRoomList()" style="display: none; padding: 8px 12px; background: #f0f0f0; border: none; border-radius: 8px; cursor: pointer; font-size: 14px;">
                            ← 뒤로
                        </button>
                        <h3 id="chatPartnerName" style="margin: 0; font-size: 16px;">채팅 상대</h3>
                    </div>
                </div>
                
                <!-- 메시지 영역 -->
                <div id="chatMessages" style="flex: 1; overflow-y: auto; padding: 20px; background: #f8f9fa;">
                    <div style="display: flex; justify-content: center; align-items: center; height: 100%; color: #999;">
                        <p>채팅방을 선택해주세요.</p>
                    </div>
                </div>
                
                <!-- 메시지 입력 -->
                <div id="chatInputArea" style="padding: 15px; border-top: 1px solid #eee; display: none;">
                    <!-- 이미지 미리보기 -->
                    <div id="imagePreviewArea" style="display: none; margin-bottom: 10px; padding: 10px; background: #f5f5f5; border-radius: 10px;">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <img id="imagePreview" src="" style="max-width: 150px; max-height: 150px; border-radius: 8px;">
                            <button onclick="cancelImageUpload()" style="padding: 5px 10px; background: #ff4444; color: white; border: none; border-radius: 5px; cursor: pointer;">✕ 취소</button>
                        </div>
                    </div>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <label style="padding: 12px 15px; background: #f0f0f0; border-radius: 25px; cursor: pointer; display: flex; align-items: center;">
                            <input type="file" id="imageInput" accept="image/*" onchange="previewImage(event)" style="display: none;">
                            📷
                        </label>
                        <!-- 이모티콘 버튼 -->
                        <div style="position: relative;">
                            <button id="emojiBtn" onclick="toggleEmojiPanel()" style="padding: 12px 15px; background: #f0f0f0; border: none; border-radius: 25px; cursor: pointer; font-size: 18px;">
                                😀
                            </button>
                            <div id="emojiPanel" class="emoji-panel"></div>
                        </div>
                        <input type="text" id="messageInput" placeholder="메시지를 입력하세요..." 
                            style="flex: 1; padding: 12px 15px; border: 1.5px solid #ddd; border-radius: 25px; font-size: 14px; outline: none;"
                            onkeypress="if(event.key === 'Enter') sendMessage()">
                        <button onclick="sendMessage()" style="padding: 12px 24px; background: #0066cc; color: white; border: none; border-radius: 25px; cursor: pointer; font-size: 14px; font-weight: 600;">
                            전송
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 피드 페이지 -->
    <div id="feedPage" class="main-content">
        <h1 class="page-title">📸 피드</h1>

        <!-- 사용자 검색 영역 -->
        <div style="background: white; border-radius: 12px; padding: 15px; margin-bottom: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
            <div style="display: flex; gap: 10px;">
                <input type="text" id="userSearchInput" placeholder="사용자 검색 (이름 또는 이메일)" 
                    style="flex: 1; padding: 12px 15px; border: 1.5px solid #ddd; border-radius: 25px; font-size: 14px; outline: none;"
                    onkeyup="searchUsers(this.value)">
                <button onclick="clearUserSearch()" style="padding: 12px 20px; background: #f0f0f0; border: none; border-radius: 25px; cursor: pointer;">✕</button>
            </div>
            <div id="userSearchResults" style="display: none; margin-top: 15px; max-height: 300px; overflow-y: auto;"></div>
        </div>

        <!-- 인기 해시태그 -->
        <div id="popularHashtags" style="background: white; border-radius: 12px; padding: 15px; margin-bottom: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
            <h3 style="margin: 0 0 12px 0; font-size: 14px; color: #666;">🔥 인기 해시태그</h3>
            <div id="hashtagList" style="display: flex; flex-wrap: wrap; gap: 8px;">
                <span style="color: #999; font-size: 13px;">로딩 중...</span>
            </div>
        </div>
                
        <!-- 스토리 영역 -->
        <div class="story-container" style="background: white; border-radius: 12px; padding: 15px; margin-bottom: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
            <div style="display: flex; gap: 15px; overflow-x: auto; padding-bottom: 5px;">
                <!-- 내 스토리 추가 버튼 -->
                <div class="story-item" onclick="openStoryUploadModal()" style="cursor: pointer; text-align: center; min-width: 70px;">
                    <div style="width: 65px; height: 65px; border-radius: 50%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; justify-content: center; align-items: center; margin: 0 auto 5px;">
                        <span style="font-size: 28px; color: white;">+</span>
                    </div>
                    <span style="font-size: 11px; color: #666;">내 스토리</span>
                </div>
                
                <!-- 스토리 목록 -->
                <div id="storyList" style="display: flex; gap: 15px;"></div>
            </div>
        </div>
        
    

        
        <!-- 새 게시물 작성 -->
        <div style="background: white; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); padding: 20px; margin-bottom: 20px;">
            <div style="display: flex; gap: 15px;">
                <div style="width: 50px; height: 50px; background: #0066cc; border-radius: 50%; display: flex; justify-content: center; align-items: center; color: white; font-weight: bold; font-size: 18px;" id="feedUserAvatar">
                    U
                </div>
                <div style="flex: 1;">
                    <textarea id="newPostContent" placeholder="무슨 생각을 하고 계신가요?" style="width: 100%; min-height: 80px; padding: 12px; border: 1.5px solid #ddd; border-radius: 10px; font-size: 14px; resize: none; outline: none; font-family: inherit;"></textarea>
                    
                    <!-- 이미지 미리보기 -->
                    <div id="feedImagePreview" style="display: none; margin-top: 10px;">
                        <div style="position: relative; display: inline-block;">
                            <img id="feedPreviewImg" src="" style="max-width: 200px; max-height: 200px; border-radius: 10px;">
                            <button onclick="cancelFeedImage()" style="position: absolute; top: 5px; right: 5px; background: rgba(0,0,0,0.6); color: white; border: none; border-radius: 50%; width: 25px; height: 25px; cursor: pointer; font-size: 14px;">✕</button>
                        </div>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 10px;">
                        <label style="display: flex; align-items: center; gap: 8px; padding: 8px 15px; background: #f0f0f0; border-radius: 20px; cursor: pointer;">
                            <input type="file" id="feedImageInput" accept="image/*" onchange="previewFeedImage(event)" style="display: none;">
                            📷 사진 추가
                        </label>
                        <button onclick="createPost()" style="padding: 10px 25px; background: #0066cc; color: white; border: none; border-radius: 20px; cursor: pointer; font-weight: 600;">게시하기</button>
                    </div>
                </div>
            </div>
        </div>
         
        <!-- 피드 목록 -->
        <div id="feedList">
            <p style="text-align: center; color: #999; padding: 40px;">게시물이 없습니다.</p>
        </div>
        
        <!-- 더보기 버튼 -->
        <div id="loadMoreArea" style="text-align: center; padding: 20px; display: none;">
            <button onclick="loadMorePosts()" style="padding: 12px 30px; background: white; border: 2px solid #0066cc; color: #0066cc; border-radius: 25px; cursor: pointer; font-weight: 600;">더보기</button>
        </div>
    </div>

    <!-- 릴스 페이지 -->
        <div id="reelsPage" class="main-content">
        <h1 class="page-title">🎬 릴스</h1>
        
            <!-- 릴스 업로드 버튼 -->
            <div style="margin-bottom: 20px;">
                <button onclick="openReelUploadModal()" style="padding: 12px 24px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 25px; cursor: pointer; font-size: 14px; font-weight: 600;">
                    + 릴스 올리기
                </button>
            </div>
        
        <!-- 릴스 그리드 -->
            <div id="reelsGrid" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 5px;">
                <p style="grid-column: 1/-1; text-align: center; color: #999; padding: 40px;">아직 릴스가 없습니다.</p>
            </div>
        </div>

        <!-- 릴스 업로드 모달 -->
        <div id="reelUploadModal" class="modal">
            <div class="modal-content" style="max-width: 400px;">
                <div class="modal-header">
                    <h2>🎬 릴스 올리기</h2>
                    <span class="close-btn" onclick="closeReelUploadModal()">&times;</span>
                </div>
                <div class="modal-body">
                    <div style="text-align: center; margin-bottom: 15px;">
                        <video id="reelPreviewVideo" src="" style="max-width: 100%; max-height: 300px; border-radius: 10px; display: none;" controls></video>
                        <label id="reelVideoLabel" style="display: block; padding: 50px; border: 2px dashed #ddd; border-radius: 10px; cursor: pointer;">
                            <input type="file" id="reelVideoInput" accept="video/*" onchange="previewReelVideo(event)" style="display: none;">
                            <div style="color: #999;">
                                <span style="font-size: 40px;">🎬</span>
                                <p>영상을 선택하세요</p>
                                <small>(최대 60초)</small>
                            </div>
                        </label>
                    </div>
                    <textarea id="reelCaptionInput" placeholder="캡션 추가..." style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; resize: none; height: 60px; box-sizing: border-box;"></textarea>
                </div>
                <div class="modal-footer" style="text-align: right; padding-top: 15px;">
                    <button onclick="closeReelUploadModal()" style="padding: 10px 20px; background: #eee; border: none; border-radius: 8px; cursor: pointer; margin-right: 10px;">취소</button>
                    <button onclick="uploadReel()" id="uploadReelBtn" style="padding: 10px 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; cursor: pointer;">올리기</button>
                </div>
            </div>
        </div>

        <!-- 릴스 뷰어 모달 -->
        <div id="reelViewerModal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: black; z-index: 2000;">
            <div style="position: relative; width: 100%; height: 100%; display: flex; justify-content: center; align-items: center;">
                <!-- 닫기 버튼 -->
                <button onclick="closeReelViewer()" style="position: absolute; top: 20px; right: 20px; background: none; border: none; color: white; font-size: 30px; cursor: pointer; z-index: 2001;">&times;</button>
                
                <!-- 영상 -->
                <video id="reelViewerVideo" src="" style="max-width: 100%; max-height: 100%; object-fit: contain;" autoplay loop playsinline></video>
                
                <!-- 오른쪽 액션 버튼 -->
                <div style="position: absolute; right: 20px; bottom: 100px; display: flex; flex-direction: column; gap: 20px; align-items: center;">
                    <div style="text-align: center;">
                        <button id="reelLikeBtn" onclick="toggleReelLike()" style="background: none; border: none; color: white; font-size: 28px; cursor: pointer;">🤍</button>
                        <div id="reelLikeCount" style="color: white; font-size: 12px;">0</div>
                    </div>
                    <div style="text-align: center;">
                        <button onclick="openReelComments()" style="background: none; border: none; color: white; font-size: 28px; cursor: pointer;">💬</button>
                        <div id="reelCommentCount" style="color: white; font-size: 12px;">0</div>
                    </div>
                </div>
                
                <!-- 하단 정보 -->
                <div style="position: absolute; left: 20px; bottom: 40px; color: white;">
                    <div id="reelUserName" style="font-weight: 600; margin-bottom: 5px;"></div>
                    <div id="reelCaption" style="font-size: 14px; max-width: 250px;"></div>
                </div>
                
                <!-- 이전/다음 버튼 -->
                <button onclick="prevReel()" style="position: absolute; left: 10px; top: 50%; transform: translateY(-50%); background: rgba(255,255,255,0.2); border: none; color: white; font-size: 24px; padding: 15px; cursor: pointer; border-radius: 50%;">❮</button>
                <button onclick="nextReel()" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: rgba(255,255,255,0.2); border: none; color: white; font-size: 24px; padding: 15px; cursor: pointer; border-radius: 50%;">❯</button>
            </div>
        </div>


    <!-- 댓글 모달 -->
    <div id="commentModal" class="modal">
        <div class="modal-content" style="max-width: 500px; max-height: 80vh; display: flex; flex-direction: column;">
            <div class="modal-header">
                <h2>💬 댓글</h2>
                <button class="close-btn" onclick="closeCommentModal()">×</button>
            </div>
            <div class="modal-body" style="flex: 1; overflow-y: auto; padding: 15px;">
                <div id="commentList" style="margin-bottom: 15px;">
                    <p style="text-align: center; color: #999;">댓글이 없습니다.</p>
                </div>
            </div>
            <div style="padding: 15px; border-top: 1px solid #eee;">
                <div style="display: flex; gap: 10px;">
                    <input type="text" id="commentInput" placeholder="댓글을 입력하세요..." style="flex: 1; padding: 12px 15px; border: 1.5px solid #ddd; border-radius: 25px; outline: none;" onkeypress="if(event.key === 'Enter') submitComment()">
                    <button onclick="submitComment()" style="padding: 12px 20px; background: #0066cc; color: white; border: none; border-radius: 25px; cursor: pointer; font-weight: 600;">등록</button>
                </div>
            </div>
        </div>
    </div>




    <!-- 페이지 관리 -->
    <div id="settingsPage" class="main-content">
        <h1 class="page-title">페이지 관리</h1>
        <div class="settings-container">
            <div class="settings-card">
                <h2>📊 테이블 컬럼 관리</h2>
                <p class="card-description">자산 조회 테이블의 컬럼 순서와 너비를 자유롭게 조절할 수 있습니다.</p>
                <div class="settings-button-area">
                    <button type="button" class="btn-open-column-settings" id="openColumnSettingsBtn">
                        <span>⚙️</span>
                        <span>컬럼 설정 관리</span>
                    </button>
                    <p class="settings-hint">버튼을 클릭하여 컬럼 순서 변경 및 크기 조절을 할 수 있습니다.</p>
                </div>
            </div>

            <div class="settings-card" style="margin-top: 20px;">
                <h2>📝 등록 항목 관리</h2>
                <p class="card-description">자산 등록 페이지의 입력 항목을 추가하거나 삭제할 수 있습니다.</p>
                <div class="settings-button-area">
                    <button type="button" class="btn-open-column-settings" id="openFieldSettingsBtn">
                        <span>📋</span>
                        <span>등록 항목 관리</span>
                    </button>
                    <p class="settings-hint">자산 등록 시 입력할 항목을 추가하거나 삭제할 수 있습니다.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- 새 채팅 모달 -->
    <div id="newChatModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2>새 채팅 시작</h2>
                <button class="close-btn" onclick="closeNewChatModal()">×</button>
            </div>
            <div class="modal-body">
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 10px; font-weight: 600;">채팅 유형</label>
                    <div style="display: flex; gap: 10px;">
                        <button id="btnDirectChat" onclick="selectChatType('direct')" style="flex: 1; padding: 15px; border: 2px solid #0066cc; background: #e3f2fd; border-radius: 8px; cursor: pointer; font-weight: 600; color: #0066cc;">
                            💬 1:1 채팅
                        </button>
                        <button id="btnGroupChat" onclick="selectChatType('group')" style="flex: 1; padding: 15px; border: 2px solid #ddd; background: white; border-radius: 8px; cursor: pointer; font-weight: 600; color: #666;">
                            👥 그룹 채팅
                        </button>
                    </div>
                </div>
                
                <!-- 그룹 채팅 이름 (그룹일 때만 표시) -->
                <div id="groupNameArea" style="margin-bottom: 20px; display: none;">
                    <label style="display: block; margin-bottom: 10px; font-weight: 600;">그룹 이름</label>
                    <input type="text" id="groupNameInput" placeholder="그룹 채팅방 이름을 입력하세요" 
                        style="width: 100%; padding: 12px; border: 1.5px solid #ddd; border-radius: 8px; font-size: 14px;">
                </div>
                
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 10px; font-weight: 600;">대화 상대 선택</label>
                    <div id="userSelectList" style="max-height: 300px; overflow-y: auto; border: 1px solid #ddd; border-radius: 8px;">
                        <p style="text-align: center; padding: 20px; color: #999;">로딩 중...</p>
                    </div>
                </div>
                
                <button onclick="createNewChat()" style="width: 100%; padding: 15px; background: #0066cc; color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer;">
                    채팅 시작하기
                </button>
            </div>
        </div>
    </div>



    <!-- 수정 모달 -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>자산 정보 수정</h2>
                <span class="close-modal" id="closeModal">&times;</span>
            </div>
            <form id="editForm">
                <div class="form-grid">
                    <!-- 동적으로 생성됨 -->
                </div>
                <div class="modal-buttons">
                    <button type="submit" class="btn-primary">저장</button>
                    <button type="button" class="btn-cancel_c" id="cancelEdit">취소</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 컬럼 설정 모달 -->
    <div id="columnSettingsModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2>⚙️ 컬럼 설정</h2>
                <span class="close-modal" id="closeColumnSettings">&times;</span>
            </div>
            <div class="column-settings-modal-body">
                <p class="settings-info">드래그로 순서를 변경하고, 크기를 조절하세요.</p>
                <div id="columnList" class="column-list"></div>
                <div class="settings-actions">
                    <button type="button" class="btn-primary" id="saveColumnSettings">설정 저장</button>
                    <button type="button" class="btn-reset_c" id="resetColumnSettings">초기화</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 등록 항목 설정 모달 -->
    <div id="fieldSettingsModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2>📋 등록 항목 관리</h2>
                <span class="close-modal" id="closeFieldSettings">&times;</span>
            </div>
            <div class="column-settings-modal-body">
                <p class="settings-info">현재 등록 항목 목록입니다. 새 항목을 추가하거나 기존 항목을 삭제할 수 있습니다.</p>
                
                <div style="background: #fff3cd; border-left: 4px solid #ffc107; padding: 15px; margin-bottom: 25px; border-radius: 4px;">
                    <p style="margin: 0; color: #856404; font-size: 14px;">
                        ℹ️ <strong>안내:</strong> 기본 8개 항목의 이름과 타입을 변경할 수 있습니다. 각 항목의 <strong>"수정"</strong> 버튼을 클릭하세요.
                    </p>
                </div>

                <h3 style="color: #002c5f; margin-bottom: 15px; font-size: 16px;">📋 현재 항목 목록</h3>
                <div id="fieldList" class="column-list"></div>
                
                <div class="settings-actions">
                    <button type="button" class="btn-primary" id="saveFieldSettings">설정 저장</button>
                    <button type="button" class="btn-reset_c" id="resetFieldSettings">초기화</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 권한 설정 모달 -->
    <div id="permissionModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>🔐 권한 설정</h2>
                <span class="close-modal" id="closePermissionModal">&times;</span>
            </div>
            <div style="padding: 30px;">
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 25px;">
                    <p style="margin: 5px 0;"><strong>이름:</strong> <span id="permissionUserName"></span></p>
                    <p style="margin: 5px 0;"><strong>이메일:</strong> <span id="permissionUserEmail"></span></p>
                </div>
                
                <h3 style="color: #002c5f; margin-bottom: 15px; font-size: 16px;">메뉴 접근 권한</h3>
                
                <div class="permission-item">
                    <label class="permission-label">
                        <input type="checkbox" id="permViewAssets" class="permission-checkbox">
                        <span class="permission-text">
                            <strong>자산 조회</strong>
                            <small>등록된 자산 목록을 조회할 수 있습니다.</small>
                        </span>
                    </label>
                </div>
                
                <div class="permission-item">
                    <label class="permission-label">
                        <input type="checkbox" id="permRegisterAssets" class="permission-checkbox">
                        <span class="permission-text">
                            <strong>자산 등록</strong>
                            <small>새로운 자산을 등록할 수 있습니다.</small>
                        </span>
                    </label>
                </div>
                
                <div class="permission-item">
                    <label class="permission-label">
                        <input type="checkbox" id="permPageSettings" class="permission-checkbox">
                        <span class="permission-text">
                            <strong>페이지 관리</strong>
                            <small>컬럼 설정 및 등록 항목을 관리할 수 있습니다.</small>
                        </span>
                    </label>
                </div>
                
                <div class="permission-item">
                    <label class="permission-label">
                        <input type="checkbox" id="permAdminPage" class="permission-checkbox">
                        <span class="permission-text">
                            <strong>관리자</strong>
                            <small>회원 목록 조회 및 권한 설정을 할 수 있습니다.</small>
                        </span>
                    </label>
                </div>
                
                <div class="permission-item">
                    <label class="permission-label">
                        <input type="checkbox" id="permChat" class="permission-checkbox">
                        <span class="permission-text">
                            <strong>채팅</strong>
                            <small>다른 사용자와 채팅할 수 있습니다.</small>
                        </span>
                    </label>
                </div>

                <div class="permission-item">
                    <label class="permission-label">
                        <input type="checkbox" id="permFeed" class="permission-checkbox">
                        <span class="permission-text">
                            <strong>피드</strong>
                            <small>피드에 게시물을 작성하고 볼 수 있습니다.</small>
                        </span>
                    </label>
                </div>

                <div class="permission-item">
                <label class="permission-label">
                    <input type="checkbox" id="permReels" class="permission-checkbox">
                    <span class="permission-text">
                        <strong>릴스</strong>
                        <small>릴스 영상을 업로드하고 볼 수 있습니다.</small>
                    </span>
                </label>
            </div>

                <div class="modal-buttons" style="margin-top: 30px;">
                    <button type="button" class="btn-primary" onclick="savePermissions()">저장</button>
                    <button type="button" class="btn-cancel" onclick="closePermissionModal()">취소</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 스토리 업로드 모달 -->
    <div id="storyUploadModal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h2>📱 스토리 올리기</h2>
                <span class="close-btn" onclick="closeStoryUploadModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div style="text-align: center; margin-bottom: 15px;">
                    <img id="storyPreviewImage" src="" style="max-width: 100%; max-height: 300px; border-radius: 10px; display: none;">
                    <label id="storyImageLabel" style="display: block; padding: 50px; border: 2px dashed #ddd; border-radius: 10px; cursor: pointer;">
                        <input type="file" id="storyImageInput" accept="image/*" onchange="previewStoryImage(event)" style="display: none;">
                        <div style="color: #999;">
                            <span style="font-size: 40px;">📷</span>
                            <p>이미지를 선택하세요</p>
                        </div>
                    </label>
                </div>
                <textarea id="storyTextInput" placeholder="텍스트 추가 (선택)" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; resize: none; height: 60px; box-sizing: border-box;"></textarea>
            </div>
            <div class="modal-footer" style="text-align: right; padding-top: 15px;">
                <button onclick="closeStoryUploadModal()" style="padding: 10px 20px; background: #eee; border: none; border-radius: 8px; cursor: pointer; margin-right: 10px;">취소</button>
                <button onclick="uploadStory()" style="padding: 10px 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; border-radius: 8px; cursor: pointer;">올리기</button>
            </div>
        </div>
    </div>

    <!-- 스토리 뷰어 모달 -->
    <div id="storyViewerModal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: black; z-index: 2000;">
        <div style="position: relative; width: 100%; height: 100%; display: flex; justify-content: center; align-items: center;">
            <!-- 닫기 버튼 -->
            <button onclick="closeStoryViewer()" style="position: absolute; top: 20px; right: 20px; background: none; border: none; color: white; font-size: 30px; cursor: pointer; z-index: 2001;">&times;</button>
            
            <!-- 사용자 정보 -->
            <div style="position: absolute; top: 20px; left: 20px; display: flex; align-items: center; gap: 10px; z-index: 2001;">
                <div id="storyViewerAvatar" style="width: 40px; height: 40px; border-radius: 50%; background: #667eea; display: flex; justify-content: center; align-items: center; color: white; font-weight: bold;"></div>
                <div>
                    <div id="storyViewerName" style="color: white; font-weight: 600;"></div>
                    <div id="storyViewerTime" style="color: #aaa; font-size: 12px;"></div>
                </div>
            </div>
            
            <!-- 진행바 -->
            <div style="position: absolute; top: 70px; left: 20px; right: 20px; height: 3px; background: rgba(255,255,255,0.3); border-radius: 2px;">
                <div id="storyProgressBar" style="height: 100%; background: white; border-radius: 2px; width: 0%; transition: width 0.1s linear;"></div>
            </div>
            
            <!-- 스토리 이미지 -->
            <img id="storyViewerImage" src="" style="max-width: 100%; max-height: 80%; object-fit: contain;">
            
            <!-- 스토리 텍스트 -->
            <div id="storyViewerText" style="position: absolute; bottom: 80px; left: 20px; right: 20px; text-align: center; color: white; font-size: 18px; text-shadow: 0 2px 4px rgba(0,0,0,0.5);"></div>
            
            <!-- 이전/다음 버튼 -->
            <button onclick="prevStory()" style="position: absolute; left: 10px; top: 50%; transform: translateY(-50%); background: rgba(255,255,255,0.2); border: none; color: white; font-size: 24px; padding: 15px; cursor: pointer; border-radius: 50%;">❮</button>
            <button onclick="nextStory()" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: rgba(255,255,255,0.2); border: none; color: white; font-size: 24px; padding: 15px; cursor: pointer; border-radius: 50%;">❯</button>
        </div>
    </div>

    <!-- 마이페이지 모달 -->
    <div id="myPageModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h2>👤 마이페이지</h2>
                <button class="close-btn" onclick="closeMyPage()">×</button>
            </div>
            <div class="modal-body" style="padding: 0;">
                <!-- 탭 메뉴 -->
                <div class="mypage-tabs">
                    <button class="mypage-tab active" onclick="switchMyPageTab('info')">📋 내 정보</button>
                    <button class="mypage-tab" onclick="switchMyPageTab('follow')">👥 팔로우</button>
                    <button class="mypage-tab" onclick="switchMyPageTab('password')">🔑 비밀번호 변경</button>
                </div>
                
                <!-- 내 정보 탭 -->
                <div id="myPageInfo" class="mypage-content active">
                    <div style="padding: 25px;">
                        <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                            <h3 style="margin-bottom: 15px; color: #002c5f; font-size: 16px;">📋 기본 정보</h3>
                            <p style="margin: 10px 0;"><strong>이름:</strong> <span id="myName">-</span></p>
                            <p style="margin: 10px 0;"><strong>이메일:</strong> <span id="myEmail">-</span></p>
                            <p style="margin: 10px 0;"><strong>가입일:</strong> <span id="myJoinDate">-</span></p>
                            <p style="margin: 10px 0;"><strong>마지막 로그인:</strong> <span id="myLastLogin">-</span></p>
                        </div>
                        
                        <div style="background: #f8f9fa; padding: 20px; border-radius: 8px;">
                            <h3 style="margin-bottom: 15px; color: #002c5f; font-size: 16px;">🔐 내 권한</h3>
                            <div id="myPermissions" style="display: flex; flex-wrap: wrap; gap: 8px;">
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 팔로우 탭 -->
                <div id="myPageFollow" class="mypage-content">
                    <div style="padding: 25px;">
                        <!-- 팔로워/팔로잉 카운트 -->
                        <div style="display: flex; justify-content: center; gap: 40px; margin-bottom: 25px;">
                            <div style="text-align: center; cursor: pointer;" onclick="showFollowList('followers')">
                                <div style="font-size: 24px; font-weight: bold; color: #0066cc;" id="myFollowerCount">0</div>
                                <div style="color: #666; font-size: 14px;">팔로워</div>
                            </div>
                            <div style="text-align: center; cursor: pointer;" onclick="showFollowList('following')">
                                <div style="font-size: 24px; font-weight: bold; color: #0066cc;" id="myFollowingCount">0</div>
                                <div style="color: #666; font-size: 14px;">팔로잉</div>
                            </div>
                        </div>
                        
                        <!-- 팔로우 목록 -->
                        <div style="border-top: 1px solid #eee; padding-top: 20px;">
                            <div style="display: flex; justify-content: center; gap: 10px; margin-bottom: 15px;">
                                <button class="follow-tab-btn active" id="followersTabBtn" onclick="showFollowList('followers')">팔로워</button>
                                <button class="follow-tab-btn" id="followingTabBtn" onclick="showFollowList('following')">팔로잉</button>
                            </div>
                            <div id="followListContainer" style="max-height: 250px; overflow-y: auto;">
                                <p style="text-align: center; color: #999; padding: 20px;">목록이 없습니다.</p>
                            </div>
                        </div>
                    </div>
                </div>



                <!-- 비밀번호 변경 탭 -->
                <div id="myPagePassword" class="mypage-content">
                    <div style="padding: 25px;">
                        <div style="background: #fff3cd; padding: 20px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #ffc107;">
                            <p style="margin: 0; color: #856404; font-size: 14px;">
                                ⚠️ 비밀번호 변경 후 다시 로그인해야 합니다.
                            </p>
                        </div>
                        
                        <div class="form-group" style="margin-bottom: 15px;">
                            <label style="font-size: 14px; font-weight: 600;">현재 비밀번호</label>
                            <input type="password" id="currentPassword" style="width: 100%; padding: 12px; border: 1.5px solid #ddd; border-radius: 6px; box-sizing: border-box; margin-top: 5px;">
                        </div>
                        <div class="form-group" style="margin-bottom: 15px;">
                            <label style="font-size: 14px; font-weight: 600;">새 비밀번호</label>
                            <input type="password" id="newPassword" style="width: 100%; padding: 12px; border: 1.5px solid #ddd; border-radius: 6px; box-sizing: border-box; margin-top: 5px;">
                            <small style="color: #666; font-size: 12px;">최소 8자 이상</small>
                        </div>
                        <div class="form-group" style="margin-bottom: 20px;">
                            <label style="font-size: 14px; font-weight: 600;">새 비밀번호 확인</label>
                            <input type="password" id="confirmNewPassword" style="width: 100%; padding: 12px; border: 1.5px solid #ddd; border-radius: 6px; box-sizing: border-box; margin-top: 5px;">
                        </div>
                        <button onclick="changePassword()" style="width: 100%; padding: 14px; background: #0066cc; color: white; border: none; border-radius: 6px; font-size: 16px; font-weight: 600; cursor: pointer;">
                            비밀번호 변경
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>




    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script src="js/main.js"></script>


</body>
</html>