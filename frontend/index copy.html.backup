<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>자산 관리 시스템</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="header">
        <div class="logo">ASSET MANAGER</div>
        <div class="user-info" id="userInfo" style="display: none;">
            <span id="currentUser"></span>
            <button class="btn-logout" id="logoutBtn">로그아웃</button>
        </div>
    </div>

    <nav class="nav" id="mainNav">
        <ul class="nav-menu">
            <li class="nav-item active" id="navList">자산 조회</li>
            <li class="nav-item" id="navRegister">자산 등록</li>
          <li class="nav-item" id="navDashboard">현황</li>
            <li class="nav-item" id="navSettings">페이지 관리</li>
            <li class="nav-item" id="navAdmin">관리자</li>
        </ul>
    </nav>

    <div id="loginPage" class="login-container">
        <div class="login-box">
            <h2>자산 관리 시스템</h2>
            
            <div class="tabs">
                <div class="tab active" id="loginTab">로그인</div>
                <div class="tab" id="signupTab">회원가입</div>
            </div>

            <div id="messageBox"></div>

            <form id="loginForm">
                <div class="form-group">
                    <label>이메일</label>
                    <input type="email" id="loginEmail" required autocomplete="username">
                    <small class="form-help" id="loginEmailError"></small>
                </div>
                <div class="form-group">
                    <label>비밀번호</label>
                    <div class="password-input-wrapper">
                        <input type="password" id="loginPassword" required autocomplete="current-password">
                        <button type="button" class="password-toggle" onclick="togglePassword('loginPassword')">
                            <span class="eye-icon">👁️</span>
                        </button>
                    </div>
                    <small class="form-help" id="loginAttempts"></small>
                </div>
                <button type="submit" class="btn-primary">로그인</button>
            </form>

            <form id="signupForm" class="hidden">
                <div class="form-group">
                    <label>이름</label>
                    <input type="text" id="signupName" required minlength="2">
                    <small class="form-help">최소 2자 이상</small>
                </div>
                <div class="form-group">
                    <label>이메일</label>
                    <input type="email" id="signupEmail" required autocomplete="username">
                    <small class="form-help" id="emailHelp"></small>
                </div>
                <div class="form-group">
                    <label>비밀번호</label>
                    <div class="password-input-wrapper">
                        <input type="password" id="signupPassword" required minlength="8" autocomplete="new-password">
                        <button type="button" class="password-toggle" onclick="togglePassword('signupPassword')">
                            <span class="eye-icon">👁️</span>
                        </button>
                    </div>
                    <div class="password-strength" id="passwordStrength">
                        <div class="strength-bar">
                            <div class="strength-bar-fill" id="strengthBar"></div>
                        </div>
                        <small class="strength-text" id="strengthText">비밀번호를 입력하세요</small>
                    </div>
                    <small class="form-help">최소 8자, 대/소문자, 숫자, 특수문자 중 3가지 이상</small>
                </div>
                <div class="form-group">
                    <label>비밀번호 확인</label>
                    <div class="password-input-wrapper">
                        <input type="password" id="signupConfirm" required autocomplete="new-password">
                        <button type="button" class="password-toggle" onclick="togglePassword('signupConfirm')">
                            <span class="eye-icon">👁️</span>
                        </button>
                    </div>
                    <small class="form-help" id="confirmHelp"></small>
                </div>
                <button type="submit" class="btn-primary">회원가입</button>
            </form>
        </div>
    </div>

    <div id="registerPage" class="main-content">
        <h1 class="page-title">자산 등록</h1>
        <div class="asset-form">
            <div class="form-section">
                <form id="assetForm">
                    <h3 class="section-title">기본 정보</h3>
                    <div class="form-grid" id="basicInfoGrid">
                        <!-- 동적으로 생성됨 -->
                    </div>
                    
                    <h3 class="section-title">추가 정보</h3>
                    <div class="form-grid" id="additionalInfoGrid">
                        <!-- 동적으로 생성됨 -->
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit" class="btn-submit">
                            <span>등록하기</span>
                        </button>
                        <button type="reset" class="btn-reset">
                            <span>초기화</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div id="listPage" class="main-content">
        <h1 class="page-title">자산 조회</h1>
        <div style="background: #e3f2fd; border-left: 4px solid #0066cc; padding: 12px 20px; margin-bottom: 20px; border-radius: 4px;">
            <p style="margin: 0; color: #002c5f; font-size: 14px;">
                💡 <strong>팁:</strong> 테이블 헤더를 드래그하여 컬럼 순서를 변경하거나, 헤더 오른쪽 끝을 드래그하여 크기를 조절할 수 있습니다.
            </p>
        </div>
        <div class="table-container">
            <table id="assetTable">
                <thead>
                    <tr id="tableHeader">
                    </tr>
                </thead>
                <tbody id="assetTableBody">
                </tbody>
            </table>
        </div>
        <div class="pagination-container" id="paginationContainer">
            <div class="pagination-info">
                <span id="paginationInfo">총 0개</span>
            </div>
            <div class="pagination-buttons" id="paginationButtons">
            </div>
        </div>
    </div>

    <!-- 대시보드 페이지 -->
    <div id="dashboardPage" class="main-content">
        <h1 class="page-title">📊 현황</h1>
        
        <div class="dashboard-controls" style="background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
            <h3 style="margin-bottom: 15px; color: #002c5f;">그래프 설정</h3>
            <div style="display: flex; gap: 15px; align-items: end; flex-wrap: wrap;">
                <div style="flex: 1; min-width: 200px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #666;">그래프 종류</label>
                    <select id="chartType" style="width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 6px; font-size: 14px;">
                        <option value="bar">막대 그래프</option>
                        <option value="pie">원 그래프</option>
                        <option value="line">선 그래프</option>
                        <option value="doughnut">도넛 그래프</option>
                    </select>
                </div>
                <div style="flex: 1; min-width: 200px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #666;">분석 항목</label>
                    <select id="analyzeField" style="width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 6px; font-size: 14px;">
                        <option value="">항목 선택</option>
                    </select>
                </div>
                <div style="flex: 1; min-width: 200px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #666;">집계 방식</label>
                    <select id="aggregateType" style="width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 6px; font-size: 14px;">
                        <option value="count">개수</option>
                        <option value="sum">합계 (가격)</option>
                        <option value="avg">평균 (가격)</option>
                    </select>
                </div>
                <button type="button" class="btn-primary" id="generateChartBtn" style="padding: 10px 30px; height: 44px;">
                    그래프 생성
                </button>
            </div>
        </div>
        
        <div class="dashboard-stats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
            <div class="stat-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                <div style="font-size: 14px; opacity: 0.9;">전체 자산</div>
                <div style="font-size: 32px; font-weight: bold; margin: 10px 0;" id="totalAssets">0</div>
            </div>
            <div class="stat-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                <div style="font-size: 14px; opacity: 0.9;">총 자산 가치</div>
                <div style="font-size: 32px; font-weight: bold; margin: 10px 0;" id="totalValue">0원</div>
            </div>
            <div class="stat-card" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                <div style="font-size: 14px; opacity: 0.9;">평균 가격</div>
                <div style="font-size: 32px; font-weight: bold; margin: 10px 0;" id="avgPrice">0원</div>
            </div>
        </div>
        
       <div class="chart-container" style="background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); position: relative;">
            <button type="button" id="openChartSettings" style="position: absolute; top: 20px; right: 20px; background: #667eea; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 14px; display: flex; align-items: center; gap: 5px; box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3); transition: all 0.3s;">
                <span>⚙️</span>
                <span>차트 설정</span>
            </button>
            <canvas id="mainChart" style="max-height: 400px;"></canvas>
        </div>

        
        <!-- 차트 설정 모달 -->
        <div id="chartSettingsModal" class="modal">
            <div class="modal-content" style="max-width: 400px;">
                <div class="modal-header">
                    <h2>⚙️ 차트 설정</h2>
                    <span class="close-modal" id="closeChartSettings">&times;</span>
                </div>
                <div style="padding: 30px;">
                    <div style="margin-bottom: 20px;">
                        <label style="display: flex; align-items: center; cursor: pointer; padding: 10px; background: #f8f9fa; border-radius: 6px; margin-bottom: 10px; transition: background 0.2s;">
                            <input type="checkbox" id="showLegend" checked style="margin-right: 10px; width: 18px; height: 18px; cursor: pointer;">
                            <span style="font-size: 14px;">범례 표시</span>
                        </label>
                        
                        <label style="display: flex; align-items: center; cursor: pointer; padding: 10px; background: #f8f9fa; border-radius: 6px; margin-bottom: 10px; transition: background 0.2s;">
                            <input type="checkbox" id="showTitle" checked style="margin-right: 10px; width: 18px; height: 18px; cursor: pointer;">
                            <span style="font-size: 14px;">제목 표시</span>
                        </label>
                        
                        <label style="display: flex; align-items: center; cursor: pointer; padding: 10px; background: #f8f9fa; border-radius: 6px; margin-bottom: 10px; transition: background 0.2s;">
                            <input type="checkbox" id="showGrid" checked style="margin-right: 10px; width: 18px; height: 18px; cursor: pointer;">
                            <span style="font-size: 14px;">격자선 표시</span>
                        </label>
                        
                        <label style="display: flex; align-items: center; cursor: pointer; padding: 10px; background: #f8f9fa; border-radius: 6px; margin-bottom: 10px; transition: background 0.2s;">
                            <input type="checkbox" id="showAnimation" checked style="margin-right: 10px; width: 18px; height: 18px; cursor: pointer;">
                            <span style="font-size: 14px;">애니메이션</span>
                        </label>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #666; font-size: 13px;">범례 위치</label>
                        <select id="legendPosition" style="width: 100%; padding: 10px; border: 2px solid #e0e0e0; border-radius: 6px; font-size: 14px;">
                            <option value="top">상단</option>
                            <option value="bottom">하단</option>
                            <option value="left">좌측</option>
                            <option value="right" selected>우측</option>
                        </select>
                    </div>
                    
                    <div style="margin-bottom: 25px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #666; font-size: 13px;">차트 높이</label>
                        <input type="range" id="chartHeight" min="300" max="600" value="400" step="50" style="width: 100%;">
                        <div style="text-align: center; font-size: 12px; color: #999; margin-top: 5px;">
                            <span id="chartHeightValue">400</span>px
                        </div>
                    </div>
                    
                    <div class="modal-buttons">
                        <button type="button" class="btn-primary" id="applyChartSettings" style="flex: 1;">
                            설정 적용
                        </button>
                        <button type="button" class="btn-reset_c" id="resetChartSettings" style="flex: 1;">
                            초기화
                        </button>
                    </div>
                </div>
            </div>
        </div>  
    </div>

    <div id="adminPage" class="main-content">
        <h1 class="page-title">회원 관리</h1>
        <div class="user-list" id="userListContainer"></div>
    </div>

    



    <!-- 페이지 관리 -->
    <div id="settingsPage" class="main-content">
        <h1 class="page-title">페이지 관리</h1>
        <div class="settings-container">
            <div class="settings-card">
                <h2>📊 테이블 컬럼 관리</h2>
                <p class="card-description">자산 조회 테이블의 컬럼 순서와 너비를 자유롭게 조절할 수 있습니다.</p>
                <div class="settings-button-area">
                    <button type="button" class="btn-open-column-settings" id="openColumnSettingsBtn">
                        <span>⚙️</span>
                        <span>컬럼 설정 관리</span>
                    </button>
                    <p class="settings-hint">버튼을 클릭하여 컬럼 순서 변경 및 크기 조절을 할 수 있습니다.</p>
                </div>
            </div>

            <div class="settings-card" style="margin-top: 20px;">
                <h2>📝 등록 항목 관리</h2>
                <p class="card-description">자산 등록 페이지의 입력 항목을 추가하거나 삭제할 수 있습니다.</p>
                <div class="settings-button-area">
                    <button type="button" class="btn-open-column-settings" id="openFieldSettingsBtn">
                        <span>📋</span>
                        <span>등록 항목 관리</span>
                    </button>
                    <p class="settings-hint">자산 등록 시 입력할 항목을 추가하거나 삭제할 수 있습니다.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- 수정 모달 -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>자산 정보 수정</h2>
                <span class="close-modal" id="closeModal">&times;</span>
            </div>
            <form id="editForm">
                <div class="form-grid">
                    <!-- 동적으로 생성됨 -->
                </div>
                <div class="modal-buttons">
                    <button type="submit" class="btn-primary">저장</button>
                    <button type="button" class="btn-cancel_c" id="cancelEdit">취소</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 컬럼 설정 모달 -->
    <div id="columnSettingsModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2>⚙️ 컬럼 설정</h2>
                <span class="close-modal" id="closeColumnSettings">&times;</span>
            </div>
            <div class="column-settings-modal-body">
                <p class="settings-info">드래그로 순서를 변경하고, 크기를 조절하세요.</p>
                <div id="columnList" class="column-list"></div>
                <div class="settings-actions">
                    <button type="button" class="btn-primary" id="saveColumnSettings">설정 저장</button>
                    <button type="button" class="btn-reset_c" id="resetColumnSettings">초기화</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 등록 항목 설정 모달 -->
    <div id="fieldSettingsModal" class="modal">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2>📋 등록 항목 관리</h2>
                <span class="close-modal" id="closeFieldSettings">&times;</span>
            </div>
            <div class="column-settings-modal-body">
                <p class="settings-info">현재 등록 항목 목록입니다. 새 항목을 추가하거나 기존 항목을 삭제할 수 있습니다.</p>
                
                <div style="background: #fff3cd; border-left: 4px solid #ffc107; padding: 15px; margin-bottom: 25px; border-radius: 4px;">
                    <p style="margin: 0; color: #856404; font-size: 14px;">
                        ℹ️ <strong>안내:</strong> 기본 8개 항목의 이름과 타입을 변경할 수 있습니다. 각 항목의 <strong>"수정"</strong> 버튼을 클릭하세요.
                    </p>
                </div>

                <h3 style="color: #002c5f; margin-bottom: 15px; font-size: 16px;">📋 현재 항목 목록</h3>
                <div id="fieldList" class="column-list"></div>
                
                <div class="settings-actions">
                    <button type="button" class="btn-primary" id="saveFieldSettings">설정 저장</button>
                    <button type="button" class="btn-reset_c" id="resetFieldSettings">초기화</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 권한 설정 모달 -->
    <div id="permissionModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>🔐 권한 설정</h2>
                <span class="close-modal" id="closePermissionModal">&times;</span>
            </div>
            <div style="padding: 30px;">
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 25px;">
                    <p style="margin: 5px 0;"><strong>이름:</strong> <span id="permissionUserName"></span></p>
                    <p style="margin: 5px 0;"><strong>이메일:</strong> <span id="permissionUserEmail"></span></p>
                </div>
                
                <h3 style="color: #002c5f; margin-bottom: 15px; font-size: 16px;">메뉴 접근 권한</h3>
                
                <div class="permission-item">
                    <label class="permission-label">
                        <input type="checkbox" id="permViewAssets" class="permission-checkbox">
                        <span class="permission-text">
                            <strong>자산 조회</strong>
                            <small>등록된 자산 목록을 조회할 수 있습니다.</small>
                        </span>
                    </label>
                </div>
                
                <div class="permission-item">
                    <label class="permission-label">
                        <input type="checkbox" id="permRegisterAssets" class="permission-checkbox">
                        <span class="permission-text">
                            <strong>자산 등록</strong>
                            <small>새로운 자산을 등록할 수 있습니다.</small>
                        </span>
                    </label>
                </div>
                
                <div class="permission-item">
                    <label class="permission-label">
                        <input type="checkbox" id="permPageSettings" class="permission-checkbox">
                        <span class="permission-text">
                            <strong>페이지 관리</strong>
                            <small>컬럼 설정 및 등록 항목을 관리할 수 있습니다.</small>
                        </span>
                    </label>
                </div>
                
                <div class="permission-item">
                    <label class="permission-label">
                        <input type="checkbox" id="permAdminPage" class="permission-checkbox">
                        <span class="permission-text">
                            <strong>관리자</strong>
                            <small>회원 목록 조회 및 권한 설정을 할 수 있습니다.</small>
                        </span>
                    </label>
                </div>
                
                <div class="modal-buttons" style="margin-top: 30px;">
                    <button type="button" class="btn-primary" onclick="savePermissions()">저장</button>
                    <button type="button" class="btn-cancel" onclick="closePermissionModal()">취소</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>   
    <script src="js/main.js"></script>
</body>
</html>